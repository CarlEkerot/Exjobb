%
%
% Created by christopher on 2012-05-11.
% Copyright (c) 2012 __MyCompanyName__. All rights reserved.
%
\documentclass[]{article}

% Use utf-8 encoding for foreign characters
\usepackage[utf8]{inputenc}

% Setup for fullpage use
\usepackage{fullpage}

% Uncomment some of the following if you use the features
%
% Running Headers and footers
%\usepackage{fancyhdr}

% Multipart figures
%\usepackage{subfigure}

% More symbols
%\usepackage{amsmath}
%\usepackage{amssymb}
%\usepackage{latexsym}

% Surround parts of graphics with box
\usepackage{boxedminipage}

% Package for including code in the document
\usepackage{listings}

% If you want to generate a toc for each chapter (use with book)
\usepackage{minitoc}

% This is now the recommended way for checking for PDFLaTeX:
\usepackage{ifpdf}

%\newif\ifpdf
%\ifx\pdfoutput\undefined
%\pdffalse % we are not running PDFLaTeX
%\else
%\pdfoutput=1 % we are running PDFLaTeX
%\pdftrue
%\fi

\ifpdf
\usepackage[pdftex]{graphicx}
\else
\usepackage{graphicx}
\fi
\title{Specification}
\author{-}

\date{2012-11-14}

\begin{document}

\ifpdf
\DeclareGraphicsExtensions{.pdf, .jpg, .tif}
\else
\DeclareGraphicsExtensions{.eps, .jpg}
\fi

\clearpage

\section{Methods}

* Clustering of packets
* Analyze packet sequence/order
* Inter-packet analysis
* Refinement-phase?


\section{Specification of fields}

* Identifiers (address etc)
* Sequence nbrs (incrementing)
* Type (flag that affects the rest of the packet)
* Data
* Length
* Terminating bit-sequences (used in indefinite length fields)
* Flags
* Checksums
* Timestamps
* Fragment offset
* Padding

\section{Input and output}

Input
=====
* pcaps of binary protocols (bits of data, timestamp and direction)

Output
======
* Packet type definitions (list of packet definitions, each definition has marked fields)
* Hierarchic protocol structure
* Score (a measurement of how certain the analysis is)
    

\section{Reading TCP streams}

Read Protocol Data Units (PDUs) separately. If PDU spans over several TCP packets:
Merge TCP-segments to entire PDU. Achievable by fetching TCP-data sent with no
PSH-flag set, up to the point that a packet with PSH-flag is set, which indicates
that the entire PDU has been transfered.


Datastructure for storing PDUs:

Source: The source address
Destination: The destination address
Timestamp: The pcap timestamp of the first packet in the PDU
Data: The entire PDU data

\section{Experimenting with liblinear/libsvm}

Validating SkypeIRC.cap on itself:
train: 500 packets
test: 500 packets
results:
0.994877175074
[[103172    129]
 [   413   2087]]
 Field boundaries missed: 129 (5.82%)
 False field boundaries: 413 (16.52%)

Validating dns-30628-packets.pcap on itself:
train: 500 packets
test: 500 packets
results:
0.989144193726
[[69857   323]
 [  466  2034]]
 Field boundaries missed: 323 (13.70%)
 False field boundaries: 466 (18.64%)

Mixed training set with UDP, TCP and DNS packets from the two above captures
on a mixed test set from the same:
UDP training: 3000
TCP training: 1000
DNS training: 3000
UDP testing: 1000
TCP testing: 500
DNS testing: 1000
Results:
0.977658514638
[[296751    903]
 [  6049   7467]]
 Field boundaries missed: 903 (10.79%)
 False field boundaries: 6049 (44.75%)

\end{document}
